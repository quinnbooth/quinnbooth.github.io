import*as e from"https://cdn.jsdelivr.net/npm/three@0.121.1/build/three.module.js";import{GLTFLoader as ae}from"https://cdn.jsdelivr.net/npm/three@0.121.1/examples/jsm/loaders/GLTFLoader.js";import{OrbitControls as se}from"https://cdn.jsdelivr.net/npm/three@0.121.1/examples/jsm/controls/OrbitControls.js";const le=function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))a(o);new MutationObserver(o=>{for(const l of o)if(l.type==="childList")for(const w of l.addedNodes)w.tagName==="LINK"&&w.rel==="modulepreload"&&a(w)}).observe(document,{childList:!0,subtree:!0});function i(o){const l={};return o.integrity&&(l.integrity=o.integrity),o.referrerpolicy&&(l.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?l.credentials="include":o.crossorigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function a(o){if(o.ep)return;o.ep=!0;const l=i(o);fetch(o.href,l)}};le();let x=0,G=1,ce=75;const h=new e.Scene,p=new e.PerspectiveCamera(ce,window.innerWidth/window.innerHeight,.1,1e3),y=new e.WebGLRenderer({canvas:document.querySelector("#bg"),antialias:!0});y.setPixelRatio(window.devicePixelRatio);y.setSize(window.innerWidth,window.innerHeight);y.shadowMap.enabled=!0;y.render(h,p);p.position.setZ(40);let j=2*Math.tan(p.fov*Math.PI/180/2)*p.position.z,he=j*p.aspect;p.position.setZ(500);let pe=new e.Clock;const de=new e.PointLight(16777215),X=new e.AmbientLight(16777215);X.intensity=.5;h.add(de);h.add(X);const K=new ae,ue=new e.FontLoader,z=new se(p,y.domElement);z.enabled=!1;const I=new e.Vector2,q=new e.Raycaster;new e.TextureLoader().load("images/space3.jpg");const fe=new e.SphereGeometry(3,100,10,1e3),me=new e.SphereGeometry(1,100,10,1e3),we=new e.SphereGeometry(1.3,100,10,1e3),Me=new e.SphereGeometry(1.3,100,10,1e3),ye=new e.SphereGeometry(1,100,10,1e3),ge=new e.SphereGeometry(2.3,100,10,1e3),Se=new e.CircleGeometry(2.9,100,0,1e3),ve=new e.SphereGeometry(2,100,10,1e3),xe=new e.CircleGeometry(3,100,0,1e3),Fe=new e.SphereGeometry(1.7,100,10,1e3),Ce=new e.CircleGeometry(2.5,100,0,1e3),be=new e.SphereGeometry(1.6,100,10,1e3),Pe=new e.CircleGeometry(2.4,100,0,1e3),Le=new e.MeshBasicMaterial({color:15883266,wireframe:!1}),Ae=new e.MeshStandardMaterial({color:12141824,wireframe:!1}),Ee=new e.MeshStandardMaterial({color:14134077,wireframe:!1}),Ge=new e.MeshStandardMaterial({color:4098273,wireframe:!1}),je=new e.MeshStandardMaterial({color:12335616,wireframe:!1}),ze=new e.MeshStandardMaterial({color:14925913,wireframe:!1}),Ie=new e.MeshStandardMaterial({color:15323532,wireframe:!0}),Be=new e.MeshStandardMaterial({color:15056232,wireframe:!1}),He=new e.MeshStandardMaterial({color:13812125,wireframe:!0}),Re=new e.MeshStandardMaterial({color:11988723,wireframe:!1}),Ve=new e.MeshStandardMaterial({color:13563384,wireframe:!0}),ke=new e.MeshStandardMaterial({color:1926626,wireframe:!1}),De=new e.MeshStandardMaterial({color:6590943,wireframe:!0}),V=new e.Mesh(fe,Le),Y=new e.Mesh(me,Ae),_=new e.Mesh(we,Ee),J=new e.Mesh(Me,Ge),Q=new e.Mesh(ye,je),k=new e.Mesh(ge,ze),Te=new e.Mesh(Se,Ie),D=new e.Mesh(ve,Be),We=new e.Mesh(xe,He),T=new e.Mesh(Fe,Re),Oe=new e.Mesh(Ce,Ve),W=new e.Mesh(be,ke),qe=new e.Mesh(Pe,De);var B=0,U=[],$=[],F=[];const s=[V,Y,_,J,Q,k,D,T,W];function Ne(t,r,i,a,o,l){const w=[k,D,T,W],u=[Te,We,Oe,qe];if(t==0){var P=he;j<P&&(P=j);var re=P/20;h.add(V);for(let n=1;n<s.length;n++){h.add(s[n]);var f=2*Math.PI*Math.random();s[n].position.set(r*Math.cos(f),r*Math.sin(f),0),r+=re,o.push(.005*Math.random()),F.push(0)}for(let n=0;n<u.length;n++)h.add(u[n]),u[n].position.set(w[n].position.x,w[n].position.y,0),a.push([.005*Math.random(),.005*Math.random(),.005*Math.random()]);B=1}else if(t==1){s[0].rotation.x+=i[0],s[0].rotation.y+=i[1],s[0].rotation.z+=i[2];for(let n=1;n<s.length;n++){const M=n-1;s[n].rotation.x+=i[0],s[n].rotation.y+=i[1],s[n].rotation.z+=i[2];var O=s[n].position.x,ie=s[n].position.y,L=Math.sqrt(Math.pow(O,2)+Math.pow(ie,2)),f=Math.acos(O/L)*(-2*l[M]+1)+o[M];s[n].position.x=L*Math.cos(f),s[n].position.y=L*Math.sin(f),Math.abs(f-Math.PI)<o[M]?(f=Math.PI+.001,l[M]=-1*l[M]+1):Math.abs(f)<o[M]&&(f=.001,l[M]=-1*l[M]+1)}for(let n=0;n<u.length;n++)u[n].rotation.x+=a[n][0],u[n].rotation.y+=a[n][1],u[n].rotation.z+=a[n][2],u[n].position.set(w[n].position.x,w[n].position.y,0)}else{B=0;for(var tt in o)o.pop(),F.pop();for(var nt in a)a.pop();U=[],$=[],F=[],h.background=new e.Color(0);for(const n of s)h.remove(n);for(const n of u)h.remove(n)}}const ee=new e.BufferGeometry;var te=new Float32Array(9e3);for(let t=0;t<9e3;t++)te[t]=Math.random()*600-300;ee.setAttribute("position",new e.BufferAttribute(te,3));let Ze=new e.TextureLoader().load("/images/star1.png"),Xe=new e.PointsMaterial({color:11184810,size:.75,map:Ze,transparent:!0});const Ke=new e.Points(ee,Xe);h.add(Ke);const b=new e.PointLight(16777215);b.intensity=2;h.add(b);b.position.set(-2,-2,502);var d=new e.Mesh;K.load("/models/gltf/spaceship1.glb",t=>{t.scene.scale.set(.3,.3,.3),t.scene.position.set(-4.5,.3,498),t.scene.rotation.set(Math.PI/9,-1*Math.PI/7,0),d=t.scene,h.add(d)});var m=0;function Ye(t){t==0?(m==100845&&(m=0),d.rotation.x=-.05*Math.sin(m/300)+Math.PI/10,m++):(m==100845&&(m=0),d.rotation.x=.5*Math.sin(m/300)+3*Math.PI/2,d.rotation.z=-.25*Math.sin(m/200)+Math.PI,m++)}let C,g,v;K.load("/models/gltf/typingtext1.glb",t=>{g=t.scene,g.scale.set(.25,.01,.25),g.position.set(0,.65,499),g.rotation.set(90,0,0),h.add(g),C=new e.AnimationMixer(g),t.animations.forEach(r=>{v=C.clipAction(r),v.setLoop(e.LoopOnce),v.clampWhenFinished=!0,v.enable=!0})});var S=0;let _e=`Scroll to zoom
Drag to rotate
Click Sun to pause planets
Click planet to expore contents`,c=new e.Mesh;ue.load("/models/fonts/Cairo_Bold.json",t=>{const r=new e.TextGeometry(_e,{font:t,size:1.25,height:.1});c=new e.Mesh(r,[new e.MeshPhongMaterial({color:16777215,transparent:!0}),new e.MeshPhongMaterial({color:3355443,transparent:!0})]),c.position.set(-40,-15,0),c.material[0].opacity=0,c.material[1].opacity=0,h.add(c)});function Je(t){c&&c.material[0]&&c.material[1]&&(t==1?c.material[0].opacity<1&&c.material[1].opacity<1?(c.material[0].opacity+=.002,c.material[1].opacity+=.002):S++:t==3&&(c.material[0].opacity<=0&&c.material[1].opacity<=0||(c.material[0].opacity-=.001,c.material[1].opacity-=.001)),c.lookAt(p.position.x,p.position.y,p.position.z))}window.addEventListener("click",function(t){if(x==0&&d.position.x>=-1&&d.position.y<=0)x=1;else if(x==3){let r;(r=Qe())?r.name=="sun"?G=!G:(R=.1,ne=r):S==2&&S++}});window.addEventListener("mousemove",function(t){I.x=t.clientX/this.innerWidth*2-1,I.y=(t.clientY/this.innerHeight*2-1)*-1});window.addEventListener("resize",function(){p.aspect=window.innerWidth/this.window.innerHeight,p.updateProjectionMatrix(),y.setSize(window.innerWidth,window.innerHeight)});V.name="sun";Y.name="mercury";_.name="venus";J.name="earth";Q.name="mars";k.name="jupiter";D.name="saturn";T.name="uranus";W.name="neptune";function N(t){let r=0,i=new e.Vector3;return i.copy(t.position),r=i.sub(p.position).length(),r}function Qe(){let t=[];q.setFromCamera(I,p);const r=q.intersectObjects(h.children);if(r.length>0)for(let a=0;a<r.length;a++)for(let o=0;o<s.length;o++)r[a].object.name==s[o].name&&t.push(s[o]);let i=t[0];if(t.length>1)for(let a=1;a<t.length;a++)N(t[a])<N(i)&&(i=t[a]);return i}let ne,H=0,A=new e.Vector3(0,0,0),R=.1,Ue=5e-4,$e=new e.Vector3(1e-4,0,0);function et(t,r){if(r==0)A=new e.Vector3(-.1,0,0),H++;else if(r==1)d.position.x>25?d.position.add(A):H++,A.add($e);else if(t){let i=new e.Vector3;i.copy(t.position),i.sub(d.position),i.normalize(),i.multiplyScalar(-R),R+=Ue,d.position.sub(i),d.position.z=3}}var Z=!0,E=0;function oe(){requestAnimationFrame(oe);var t=pe.getDelta();C&&C.update(t),Z&&(h.remove(b),p.position.setZ(40),S=1,Z=!1),E++,E==5?(d.position.set(75,-15,3),d.rotation.y=0):E>5&&(Ye(1),et(ne,H)),z.enabled=!0,G&&Ne(B,5,[.002,.001,.003],$,U,F),Je(S),x=3,z.update(),y.render(h,p)}oe();
