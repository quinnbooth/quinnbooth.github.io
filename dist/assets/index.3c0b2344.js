import*as e from"https://cdn.jsdelivr.net/npm/three@0.121.1/build/three.module.js";import{GLTFLoader as ae}from"https://cdn.jsdelivr.net/npm/three@0.121.1/examples/jsm/loaders/GLTFLoader.js";import{OrbitControls as se}from"https://cdn.jsdelivr.net/npm/three@0.121.1/examples/jsm/controls/OrbitControls.js";const le=function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))a(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const f of s.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&a(f)}).observe(document,{childList:!0,subtree:!0});function r(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerpolicy&&(s.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?s.credentials="include":o.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function a(o){if(o.ep)return;o.ep=!0;const s=r(o);fetch(o.href,s)}};le();let C=0,G=1,ce=75;const u=new e.Scene,d=new e.PerspectiveCamera(ce,window.innerWidth/window.innerHeight,.1,1e3),y=new e.WebGLRenderer({canvas:document.querySelector("#bg"),antialias:!0});y.setPixelRatio(window.devicePixelRatio);y.setSize(window.innerWidth,window.innerHeight);y.shadowMap.enabled=!0;y.render(u,d);d.position.setZ(40);let j=2*Math.tan(d.fov*Math.PI/180/2)*d.position.z,pe=j*d.aspect;d.position.setZ(500);let he=new e.Clock;const ue=new e.PointLight(16777215),X=new e.AmbientLight(16777215);X.intensity=.5;u.add(ue);u.add(X);const K=new ae,de=new e.FontLoader,V=new se(d,y.domElement);V.enabled=!1;const I=new e.Vector2,O=new e.Raycaster;new e.TextureLoader().load("images/space3.jpg");const fe=new e.SphereGeometry(3,100,10,1e3),me=new e.SphereGeometry(1,100,10,1e3),we=new e.SphereGeometry(1.3,100,10,1e3),Me=new e.SphereGeometry(1.3,100,10,1e3),ye=new e.SphereGeometry(1,100,10,1e3),ge=new e.SphereGeometry(2.3,100,10,1e3),Se=new e.CircleGeometry(2.9,100,0,1e3),xe=new e.SphereGeometry(2,100,10,1e3),ve=new e.CircleGeometry(3,100,0,1e3),Fe=new e.SphereGeometry(1.7,100,10,1e3),Ce=new e.CircleGeometry(2.5,100,0,1e3),be=new e.SphereGeometry(1.6,100,10,1e3),Pe=new e.CircleGeometry(2.4,100,0,1e3),Le=new e.MeshBasicMaterial({color:15883266,wireframe:!1}),Ae=new e.MeshStandardMaterial({color:12141824,wireframe:!1}),ze=new e.MeshStandardMaterial({color:14134077,wireframe:!1}),Ee=new e.MeshStandardMaterial({color:4098273,wireframe:!1}),Ge=new e.MeshStandardMaterial({color:12335616,wireframe:!1}),je=new e.MeshStandardMaterial({color:14925913,wireframe:!1}),Ve=new e.MeshStandardMaterial({color:15323532,wireframe:!0}),Ie=new e.MeshStandardMaterial({color:15056232,wireframe:!1}),Be=new e.MeshStandardMaterial({color:13812125,wireframe:!0}),He=new e.MeshStandardMaterial({color:11988723,wireframe:!1}),Re=new e.MeshStandardMaterial({color:13563384,wireframe:!0}),ke=new e.MeshStandardMaterial({color:1926626,wireframe:!1}),De=new e.MeshStandardMaterial({color:6590943,wireframe:!0}),H=new e.Mesh(fe,Le),Y=new e.Mesh(me,Ae),_=new e.Mesh(we,ze),J=new e.Mesh(Me,Ee),Q=new e.Mesh(ye,Ge),R=new e.Mesh(ge,je),Te=new e.Mesh(Se,Ve),k=new e.Mesh(xe,Ie),We=new e.Mesh(ve,Be),D=new e.Mesh(Fe,He),Oe=new e.Mesh(Ce,Re),T=new e.Mesh(be,ke),qe=new e.Mesh(Pe,De);var B=0,U=[],$=[],b=[];const p=[H,Y,_,J,Q,R,k,D,T];function Ne(t,i,r,a,o,s){const f=[R,k,D,T],c=[Te,We,Oe,qe];if(t==0){var A=pe;j<A&&(A=j);var ie=A/20;u.add(H);for(let n=1;n<p.length;n++){u.add(p[n]);var m=2*Math.PI*Math.random();p[n].position.set(i*Math.cos(m),i*Math.sin(m),0),i+=ie,o.push(.005*Math.random()),b.push(0)}for(let n=0;n<c.length;n++)u.add(c[n]),c[n].position.set(f[n].position.x,f[n].position.y,0),a.push([.005*Math.random(),.005*Math.random(),.005*Math.random()]);B=1}else if(t==1){p[0].rotation.x+=r[0],p[0].rotation.y+=r[1],p[0].rotation.z+=r[2];for(let n=1;n<p.length;n++){const w=n-1;p[n].rotation.x+=r[0],p[n].rotation.y+=r[1],p[n].rotation.z+=r[2];var W=p[n].position.x,re=p[n].position.y,z=Math.sqrt(Math.pow(W,2)+Math.pow(re,2)),m=Math.acos(W/z)*(-2*s[w]+1)+o[w];p[n].position.x=z*Math.cos(m),p[n].position.y=z*Math.sin(m),Math.abs(m-Math.PI)<o[w]?(m=Math.PI+.001,s[w]=-1*s[w]+1):Math.abs(m)<o[w]&&(m=.001,s[w]=-1*s[w]+1)}for(let n=0;n<c.length;n++)c[n].rotation.x+=a[n][0],c[n].rotation.y+=a[n][1],c[n].rotation.z+=a[n][2],c[n].position.set(f[n].position.x,f[n].position.y,0)}else{B=0;for(var $e in o)o.pop(),b.pop();for(var et in a)a.pop();U=[],$=[],b=[],u.background=new e.Color(0);for(const n of p)u.remove(n);for(const n of c)u.remove(n)}}const ee=new e.BufferGeometry;var te=new Float32Array(9e3);for(let t=0;t<9e3;t++)te[t]=Math.random()*600-300;ee.setAttribute("position",new e.BufferAttribute(te,3));let Ze=new e.TextureLoader().load("/images/star1.png"),Xe=new e.PointsMaterial({color:11184810,size:.75,map:Ze,transparent:!0});const Ke=new e.Points(ee,Xe);u.add(Ke);const L=new e.PointLight(16777215);L.intensity=2;u.add(L);L.position.set(-2,-2,502);var l=new e.Mesh;K.load("/models/gltf/spaceship1.glb",t=>{t.scene.scale.set(.3,.3,.3),t.scene.position.set(-4.5,.3,498),t.scene.rotation.set(Math.PI/9,-1*Math.PI/7,0),l=t.scene,u.add(l)});let ne,M=0,E=new e.Vector3(0,0,0),S=.1,q=5e-4,Ye=new e.Vector3(1e-4,0,0);function _e(t,i){if(i==0)E=new e.Vector3(-.1,0,0),M++;else if(i==1)l.position.x>25?l.position.add(E):M++,E.add(Ye);else if(t){if(console.log(S),i==2){let r=new e.Vector3().copy(t.position).sub(l.position).normalize();r.z=0;let a=1;l.position.x<t.position.x&&(a=-1);let o=new e.Vector3(0,a,0),s=a*Math.PI/2,f=Math.acos(r.dot(o)/(r.length()*o.length()));l.rotation.y=f+s,l.rotation.z=0,l.rotation.x=Math.PI/2;let c=new e.Vector3;c.copy(t.position),c.sub(l.position),c.normalize(),c.multiplyScalar(-S),S+=q,c.z=0,l.position.sub(c),c.copy(t.position),c.sub(l.position).lengthSq()<15&&(S+=10*q,M=3)}else if(i==3){let r=new e.Vector3;r.copy(t.position),r.sub(l.position),r.normalize(),r.multiplyScalar(-S),r.z=0,l.position.sub(r)}}}let P,g,v;K.load("/models/gltf/typingtext1.glb",t=>{g=t.scene,g.scale.set(.25,.01,.25),g.position.set(0,.65,499),g.rotation.set(90,0,0),u.add(g),P=new e.AnimationMixer(g),t.animations.forEach(i=>{v=P.clipAction(i),v.setLoop(e.LoopOnce),v.clampWhenFinished=!0,v.enable=!0})});var x=0;let Je=`Scroll to zoom
Drag to rotate
Click Sun to pause planets
Click planet to expore contents`,h=new e.Mesh;de.load("/models/fonts/Cairo_Bold.json",t=>{const i=new e.TextGeometry(Je,{font:t,size:1.25,height:.1});h=new e.Mesh(i,[new e.MeshPhongMaterial({color:16777215,transparent:!0}),new e.MeshPhongMaterial({color:3355443,transparent:!0})]),h.position.set(-40,-15,0),h.material[0].opacity=0,h.material[1].opacity=0,u.add(h)});function Qe(t){h&&h.material[0]&&h.material[1]&&(t==1?h.material[0].opacity<1&&h.material[1].opacity<1?(h.material[0].opacity+=.002,h.material[1].opacity+=.002):x++:t==3&&(h.material[0].opacity<=0&&h.material[1].opacity<=0||(h.material[0].opacity-=.001,h.material[1].opacity-=.001)),h.lookAt(d.position.x,d.position.y,d.position.z))}window.addEventListener("click",function(t){if(C==0&&l.position.x>=-1&&l.position.y<=0)C=1;else if(C==3){let i;(i=Ue())?i.name=="sun"?G=!G:(M==1?M++:M==3&&M--,S=.1,ne=i):x==2&&x++}});window.addEventListener("mousemove",function(t){I.x=t.clientX/this.innerWidth*2-1,I.y=(t.clientY/this.innerHeight*2-1)*-1});window.addEventListener("resize",function(){d.aspect=window.innerWidth/this.window.innerHeight,d.updateProjectionMatrix(),y.setSize(window.innerWidth,window.innerHeight)});H.name="sun";Y.name="mercury";_.name="venus";J.name="earth";Q.name="mars";R.name="jupiter";k.name="saturn";D.name="uranus";T.name="neptune";function N(t){let i=0,r=new e.Vector3;return r.copy(t.position),i=r.sub(d.position).length(),i}function Ue(){let t=[];O.setFromCamera(I,d);const i=O.intersectObjects(u.children);if(i.length>0)for(let a=0;a<i.length;a++)for(let o=0;o<p.length;o++)i[a].object.name==p[o].name&&t.push(p[o]);let r=t[0];if(t.length>1)for(let a=1;a<t.length;a++)N(t[a])<N(r)&&(r=t[a]);return r}var Z=!0,F=0;function oe(){requestAnimationFrame(oe);var t=he.getDelta();P&&P.update(t),Z&&(u.remove(L),d.position.setZ(40),x=1,Z=!1),F<100&&F++,F==5?(l.position.set(75,-15,3),l.rotation.x=Math.PI/2,l.rotation.y=Math.PI):F>5&&_e(ne,M),V.enabled=!0,G&&Ne(B,5,[.002,.001,.003],$,U,b),Qe(x),C=3,V.update(),y.render(u,d)}oe();
