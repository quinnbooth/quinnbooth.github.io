import*as e from"https://cdn.jsdelivr.net/npm/three@0.121.1/build/three.module.js";import{GLTFLoader as le}from"https://cdn.jsdelivr.net/npm/three@0.121.1/examples/jsm/loaders/GLTFLoader.js";import{OrbitControls as pe}from"https://cdn.jsdelivr.net/npm/three@0.121.1/examples/jsm/controls/OrbitControls.js";const he=function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))a(o);new MutationObserver(o=>{for(const p of o)if(p.type==="childList")for(const m of p.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&a(m)}).observe(document,{childList:!0,subtree:!0});function d(o){const p={};return o.integrity&&(p.integrity=o.integrity),o.referrerpolicy&&(p.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?p.credentials="include":o.crossorigin==="anonymous"?p.credentials="omit":p.credentials="same-origin",p}function a(o){if(o.ep)return;o.ep=!0;const p=d(o);fetch(o.href,p)}};he();let M=0,B=1,de=75;const l=new e.Scene,i=new e.PerspectiveCamera(de,window.innerWidth/window.innerHeight,.1,1e3),x=new e.WebGLRenderer({canvas:document.querySelector("#bg"),antialias:!0});x.setPixelRatio(window.devicePixelRatio);x.setSize(window.innerWidth,window.innerHeight);x.shadowMap.enabled=!0;x.render(l,i);i.position.setZ(40);let R=2*Math.tan(i.fov*Math.PI/180/2)*i.position.z,ue=R*i.aspect;i.position.setZ(500);let fe=new e.Clock;const me=new e.PointLight(16777215),J=new e.AmbientLight(16777215);J.intensity=.5;l.add(me);l.add(J);const Q=new le,we=new e.FontLoader,I=new pe(i,x.domElement);I.enabled=!1;const k=new e.Vector2,X=new e.Raycaster;new e.TextureLoader().load("images/space3.jpg");const Me=new e.SphereGeometry(3,100,10,1e3),ye=new e.SphereGeometry(1,100,10,1e3),ge=new e.SphereGeometry(1.3,100,10,1e3),xe=new e.SphereGeometry(1.3,100,10,1e3),ve=new e.SphereGeometry(1,100,10,1e3),Se=new e.SphereGeometry(2.3,100,10,1e3),Fe=new e.CircleGeometry(2.9,100,0,1e3),Ce=new e.SphereGeometry(2,100,10,1e3),be=new e.CircleGeometry(3,100,0,1e3),Le=new e.SphereGeometry(1.7,100,10,1e3),Pe=new e.CircleGeometry(2.5,100,0,1e3),ze=new e.SphereGeometry(1.6,100,10,1e3),Ae=new e.CircleGeometry(2.4,100,0,1e3),Ee=new e.MeshBasicMaterial({color:15883266,wireframe:!1}),Ge=new e.MeshStandardMaterial({color:12141824,wireframe:!1}),je=new e.MeshStandardMaterial({color:14134077,wireframe:!1}),Be=new e.MeshStandardMaterial({color:4098273,wireframe:!1}),Re=new e.MeshStandardMaterial({color:12335616,wireframe:!1}),Ie=new e.MeshStandardMaterial({color:14925913,wireframe:!1}),ke=new e.MeshStandardMaterial({color:15323532,wireframe:!0}),De=new e.MeshStandardMaterial({color:15056232,wireframe:!1}),He=new e.MeshStandardMaterial({color:13812125,wireframe:!0}),We=new e.MeshStandardMaterial({color:11988723,wireframe:!1}),Oe=new e.MeshStandardMaterial({color:13563384,wireframe:!0}),Te=new e.MeshStandardMaterial({color:1926626,wireframe:!1}),Ve=new e.MeshStandardMaterial({color:6590943,wireframe:!0}),H=new e.Mesh(Me,Ee),U=new e.Mesh(ye,Ge),$=new e.Mesh(ge,je),ee=new e.Mesh(xe,Be),te=new e.Mesh(ve,Re),W=new e.Mesh(Se,Ie),qe=new e.Mesh(Fe,ke),O=new e.Mesh(Ce,De),Xe=new e.Mesh(be,He),T=new e.Mesh(Le,We),Ze=new e.Mesh(Pe,Oe),V=new e.Mesh(ze,Te),Ne=new e.Mesh(Ae,Ve);var D=0,ne=[],oe=[],A=[];const s=[H,U,$,ee,te,W,O,T,V];function Ye(t,r,d,a,o,p){const m=[W,O,T,V],u=[qe,Xe,Ze,Ne];if(t==0){var G=ue;R<G&&(G=R);var se=G/20;l.add(H);for(let n=1;n<s.length;n++){l.add(s[n]);var f=2*Math.PI*Math.random();s[n].position.set(r*Math.cos(f),r*Math.sin(f),0),r+=se,o.push(.005*Math.random()),A.push(0)}for(let n=0;n<u.length;n++)l.add(u[n]),u[n].position.set(m[n].position.x,m[n].position.y,0),a.push([.005*Math.random(),.005*Math.random(),.005*Math.random()]);D=1}else if(t==1){s[0].rotation.x+=d[0],s[0].rotation.y+=d[1],s[0].rotation.z+=d[2];for(let n=1;n<s.length;n++){const w=n-1;s[n].rotation.x+=d[0],s[n].rotation.y+=d[1],s[n].rotation.z+=d[2];var q=s[n].position.x,ce=s[n].position.y,j=Math.sqrt(Math.pow(q,2)+Math.pow(ce,2)),f=Math.acos(q/j)*(-2*p[w]+1)+o[w];s[n].position.x=j*Math.cos(f),s[n].position.y=j*Math.sin(f),Math.abs(f-Math.PI)<o[w]?(f=Math.PI+.001,p[w]=-1*p[w]+1):Math.abs(f)<o[w]&&(f=.001,p[w]=-1*p[w]+1)}for(let n=0;n<u.length;n++)u[n].rotation.x+=a[n][0],u[n].rotation.y+=a[n][1],u[n].rotation.z+=a[n][2],u[n].position.set(m[n].position.x,m[n].position.y,0)}else{D=0;for(var tt in o)o.pop(),A.pop();for(var nt in a)a.pop();ne=[],oe=[],A=[],l.background=new e.Color(0);for(const n of s)l.remove(n);for(const n of u)l.remove(n)}}const ie=new e.BufferGeometry;var re=new Float32Array(9e3);for(let t=0;t<9e3;t++)re[t]=Math.random()*600-300;ie.setAttribute("position",new e.BufferAttribute(re,3));let Ke=new e.TextureLoader().load("/images/star1.png"),_e=new e.PointsMaterial({color:11184810,size:.75,map:Ke,transparent:!0});const F=new e.Points(ie,_e);l.add(F);var Z=!0,b=0,v=0;function Je(){i.position.z>250?(i.position.z+=b,b-=.001,v<.0012&&(v+=3e-6),F.rotation.z+=v):i.position.z>45?(i.position.z+=b,b+=.001225,v>75e-6&&(v-=3e-6),F.rotation.z+=v):(F.rotation.z+=75e-6,Z&&(l.remove(y),Z=!1,C=1,M++)),i.rotation.x<.25&&(i.rotation.x+=2e-4),i.position.y>-15&&(i.position.y-=6/500)}const g=new e.PointLight(16777215);g.intensity=2;l.add(g);g.position.set(-2,-2,502);var c=new e.Mesh;Q.load("/models/gltf/spaceship1.glb",t=>{t.scene.scale.set(.3,.3,.3),t.scene.position.set(-4.5,.3,498),t.scene.rotation.set(Math.PI/9,-1*Math.PI/7,0),c=t.scene,l.add(c)});var L=0;function N(t){t==0&&(L==100845&&(L=0),c.rotation.x=-.05*Math.sin(L/300)+Math.PI/10,L++)}var P=.01,z=-85e-5;const Y=-143e-7,K=12e-7;function Qe(t){t==0?(c.position.x<-1&&(c.position.x+=P,P+=Y),c.position.y>0&&(c.position.y+=z,z+=K),c.position.x>=-1&&c.position.y<=0&&S&&S.play(),N(0),F.rotation.z+=75e-6):t==1&&(c.position.x<6&&(c.position.x+=P,P-=2*Y),c.position.y>-.5&&(c.position.y+=z,z-=2*K),N(0),g.intensity>0&&(g.intensity=g.intensity-.004),c.position.x>=6&&c.position.y<=-.5&&(M++,l.remove(g)),F.rotation.z+=75e-6)}let E,y,S;Q.load("/models/gltf/typingtext1.glb",t=>{y=t.scene,y.scale.set(.25,.01,.25),y.position.set(0,.65,499),y.rotation.set(90,0,0),l.add(y),E=new e.AnimationMixer(y),t.animations.forEach(r=>{S=E.clipAction(r),S.setLoop(e.LoopOnce),S.clampWhenFinished=!0,S.enable=!0})});var C=0;let Ue=`Scroll to zoom
Drag to rotate
Click Sun to pause planets
Click planet to expore contents`,h=new e.Mesh;we.load("/models/fonts/Cairo_Bold.json",t=>{const r=new e.TextGeometry(Ue,{font:t,size:1.25,height:.1});h=new e.Mesh(r,[new e.MeshPhongMaterial({color:16777215,transparent:!0}),new e.MeshPhongMaterial({color:3355443,transparent:!0})]),h.position.set(-40,-15,0),h.material[0].opacity=0,h.material[1].opacity=0,l.add(h)});function $e(t){h&&h.material[0]&&h.material[1]&&(t==1?h.material[0].opacity<1&&h.material[1].opacity<1?(h.material[0].opacity+=.002,h.material[1].opacity+=.002):C++:t==3&&(h.material[0].opacity<=0&&h.material[1].opacity<=0||(h.material[0].opacity-=.001,h.material[1].opacity-=.001)),h.lookAt(i.position.x,i.position.y,i.position.z))}window.addEventListener("click",function(t){if(M==0&&c.position.x>=-1&&c.position.y<=0)M=1;else if(M==3){let r;(r=et())?(r.name=="sun"&&(B=!B),console.log("Clicked on: "+r.name)):C==2&&C++}});window.addEventListener("mousemove",function(t){k.x=t.clientX/this.innerWidth*2-1,k.y=(t.clientY/this.innerHeight*2-1)*-1});window.addEventListener("resize",function(){i.aspect=window.innerWidth/this.window.innerHeight,i.updateProjectionMatrix(),x.setSize(window.innerWidth,window.innerHeight)});H.name="sun";U.name="mercury";$.name="venus";ee.name="earth";te.name="mars";W.name="jupiter";O.name="saturn";T.name="uranus";V.name="neptune";function _(t){let r=0,d=new Vector3;return d.copy(t.position),r=d.sub(i.position).length(),r}function et(){let t=[];X.setFromCamera(k,i);const r=X.intersectObjects(l.children);if(r.length>0)for(let a=0;a<r.length;a++)for(let o=0;o<s.length;o++)r[a].object.name==s[o].name&&t.push(s[o]);let d=t[0];if(t.length>1)for(let a=1;a<t.length;a++)_(t[a])<_(d)&&(d=t[a]);return d}function ae(){requestAnimationFrame(ae);var t=fe.getDelta();E&&E.update(t),B&&Ye(D,5,[.002,.001,.003],oe,ne,A),c&&Qe(M),M==2&&Je(),M==3&&(I.enabled=!0,$e(C)),I.update(),x.render(l,i)}ae();
